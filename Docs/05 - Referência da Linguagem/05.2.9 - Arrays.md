# Arrays

Um array no PHP é na verdade um mapa ordenado. Um mapa é um tipo que relaciona valores a chaves. Este tipo é otimizado para várias usos diferentes: ele pode ser tratado como um array, uma lista (vetor), hashtable (que é uma implementação de mapa), dicionário, coleção, pilha, fila e provavelmente mais. Assim como existe a possibilidade dos valores do array serem outros arrays, árvores e arrays multidimensionais.

A explicação dessas estruturas está além do escopo deste manual, mas pelo menos um exemplo é dado para cada uma delas. Para mais informações, busque a considerável literatura que existe sobre esse extenso tópico.

## Sintaxe

### Especificando com array()

Um array pode ser criado com o construtor de linguagem array(). Ele leva qualquer quantidade de pares separados por vírgula chave => valor como argumentos.

```php
array(
    chave  => valor,
    chave2 => valor2,
    chave3 => valor3,
    ...
)
```

A vírgula após o último elemento do array é opcional e pode ser omitida. Isso geralmente é feito para arrays em uma única linha, por exemplo, array(1, 2) é preferível em vez de array(1, 2, ). Para arrays escritos em várias linhas, por outro lado, a vírgula à direita do último elemento é usada frequentemente, para permitir a adição de forma simples de novos elementos ao final.

> Nota: Existe uma sintaxe curta que substitui array() por [].

**Exemplo #1 Um array simples**

```php
$array = array(
    "foo" => "bar",
    "bar" => "foo",
);

// Utilizando a sintaxe curta
$array = [
    "foo" => "bar",
    "bar" => "foo",
];
```

A chave pode ser um int ou uma string. O valor pode ser de qualquer tipo.

Adicionalmente, as seguintes coerções ocorrerão a chave:

- strings contendo quaisquer ints válidos, que não sejam precedidos do sinal de +, serão convertidos para o tipo int. Por exemplo, a chave"8" será, na verdade, armazenada como 8. Entretanto, "08" não será convertido, por não ser um inteiro decimal válido.
- floats também são convertidos para ints, isso significa que a parte fracionária será removida. Por exemplo, a chave 8.7 será na verdade armazenada como 8.
- bools são convertidos para ints, igualmente, por exemplo, a chave true, será na verdade armazenada como 1 e a chave false como 0.
- null será convertido para uma string vazia, por exemplo, a chave null na verdade será armazenada como "".
- arrays e objects não podem ser usados como chaves. Fazer isso resultará em um aviso: Illegal offset type.

Se vários elementos na declaração do array utilizam a mesma chave, apenas o último será utilizado, enquanto todos os outros serão sobrescritos.

**Exemplo #2 Exemplo de conversão de tipo e sobrescrita**

```php
$array = array(
    1    => "a",
    "1"  => "b",
    1.5  => "c",
    true => "d",
);
var_dump($array);
```

O exemplo acima produzirá:


```php
array(1) {
  [1]=>
  string(1) "d"
}
```

Como todas as chaves do exemplo acima foram convertidas para 1, o valor será sobrescrito a cada novo elemento e o valor final atribuído "d", será o único que restará.

As chaves dos arrays no PHP podem conter, ao mesmo tempo, int e string, porque o PHP não faz distinção entre arrays indexados e associativos.

**Exemplo #3 Misturando int e string nas chaves**

```php
$array = array(
    "foo" => "bar",
    "bar" => "foo",
    100   => -100,
    -100  => 100,
);
var_dump($array);
```

O exemplo acima produzirá:

```php
array(4) {
  ["foo"]=>
  string(3) "bar"
  ["bar"]=>
  string(3) "foo"
  [100]=>
  int(-100)
  [-100]=>
  int(100)
}
```

A key é opcional. Se não for especificada, o PHP utilizará o incremento da chave do tipo int com maior valor utilizado.

**Exemplo #4 Arrays indexados sem chaves**

```php
$array = array("foo", "bar", "hello", "world");
var_dump($array);
```

O exemplo acima produzirá:

```php
array(4) {
  [0]=>
  string(3) "foo"
  [1]=>
  string(3) "bar"
  [2]=>
  string(5) "hello"
  [3]=>
  string(5) "world"
}
```

É possível especificar a chave somente para alguns elementos e omití-las para outros:

**Exemplo #5 Chaves em alguns elementos**

```php
$array = array(
         "a",
         "b",
    6 => "c",
         "d",
);
var_dump($array);
```

O exemplo acima produzirá:

```php
array(4) {
  [0]=>
  string(1) "a"
  [1]=>
  string(1) "b"
  [6]=>
  string(1) "c"
  [7]=>
  string(1) "d"
}
```

Como pode ver, o último valor "d" foi atribuído a chave 7. Isso acontece porque a chave com maior inteiro antes dela era 6.

**Exemplo #6 Exemplo de sobrescrita e cast de tipo complexo**

Este exemplo inclui todas as variações de cast de tipo de chaves e sobrescrita de elementos.

```php
$array = array(
    1    => 'a',
    '1'  => 'b', // o valor "a" será sobrescrito por "b"
    1.5  => 'c', // o valor "b" será sobrescrito por "c"
    -1 => 'd',
    '01'  => 'e', // não é uma string de inteiro e NÃO sobrescreve a chave 1
    '1.5' => 'f', // não é uma string de inteiro e NÃO sobrescreve a chave 1
    true => 'g', // o valor "c" será sobrescrito por "g"
    false => 'h',
    '' => 'i',
    null => 'j', // o valor "i" será sobrescrito por "j"
    'k',      // o valor "k" será alocado na chave 2. Isto porque é o maior inteiro após a chave 1
    2 => 'l', // o valor "k" será sobrescrito por "l"
);

var_dump($array);
```

O exemplo acima produzirá:

```php
array(7) {
  [1]=>
  string(1) "g"
  [-1]=>
  string(1) "d"
  ["01"]=>
  string(1) "e"
  ["1.5"]=>
  string(1) "f"
  [0]=>
  string(1) "h"
  [""]=>
  string(1) "j"
  [2]=>
  string(1) "l"
}
```

## Exemplo #7 Exemplo de índice negativo

Ao atribuir uma chave inteira negativa n, o PHP irá atribuir n+1 à chave seguinte.

```php
$array = [];

$array[-5] = 1;
$array[] = 2;

var_dump($array);
```

```php
array(2) {
  [-5]=>
  int(1)
  [-4]=>
  int(2)
}
```

> **Aviso** Antes do PHP 8.3.0, atribuir um a chave inteira negativa n causaria a atribuição de 0 à chave seguinte, portando o exemplo anterior teria este resultado:
> ```php
> array(2) {
>   [-5]=>
>   int(1)
>   [0]=>
>   int(2)
> }
> ```

## Acessando elementos do array com colchetes

Elementos do array podem ser acessados utilizando a sintaxe array[chave].

**Exemplo #8 Acessando elementos do array**

```php
$array = array(
    "foo" => "bar",
    42    => 24,
    "multi" => array(
         "dimensional" => array(
             "array" => "foo"
         )
    )
);

var_dump($array["foo"]);
var_dump($array[42]);
var_dump($array["multi"]["dimensional"]["array"]);
```

O exemplo acima produzirá:

```php
string(3) "bar"
int(24)
string(3) "foo"
```

> Nota: Anteriormente ao PHP 8.0.0, chaves e colchetes podiam ser utilizados para acessar elementos de um array (por exemplo, $array[42] e $array{42} irão fazer a mesma coisa que o exemplo anterior). O acesso por chaves foi descontinuado a partir do PHP 7.4.0 e não é mais suportado a partir do PHP 8.0.0.

**Exemplo #9 Referenciando elemento de um array**

```php
function getArray() {
    return array(1, 2, 3);
}

$secondElement = getArray()[1];
```

> Nota: Tentativas de acesso a uma chave de array que não foi definida é o mesmo que acessar qualquer outra variável indefinida: uma mensagem de erro de nível E_WARNING (E_NOTICE anteriormente ao PHP 8.0.0) será emitida, e o resultado será null.

> Nota: Acessar um array através de uma chave que não é string retorna null. Anteriormente ao PHP 7.4.0 não era emitida uma mensagem. A partir do PHP 7.4.0 emite um E_NOTICE; e a partir do PHP 8.0.0 é emitido um E_WARNING.

## Criando/modificando com a sintaxe de colchetes

Você pode também modificar um array existente explicitamente assimilando valores a ele.

Isto é feito apenas assimilando valores para o array enquanto especifica a chave em colchetes. Você pode omitir a chave, colocando um par vazio de colchetes ([]).

```php
$arr[chave] = valor;
$arr[] = valor;
// chave pode ser tanto um int quanto uma string
// valor pode ser qualquer valor de qualquer tipo
```

Se $arr ainda não existir ou estiver definido como null ou false, ele será criado, por isso também é uma alternativa para criação de um array. Entretanto, essa prática é desencorajada por que se $arr conter algum valor (por exemplo, uma string de uma variável de requisição), então este valor permanecerá e o [] funcionará como um operador de acesso a string. Sempre será recomendado a inicialização de uma variável por atribuição direta.

> Nota: A partir do PHP 7.1.0, aplicar um operador de índice vazio a uma string lança um erro fatal. Antes, a string era silenciosamente convertida em um array.

> Nota: A partir do PHP 8.1.0, criar um novo array a partir do valor false foi descontinuado. Crir um array a partir de null e valores indefinidos ainda é permitido.

Para mudar um certo valor, apenas atribua um novo valor para um elemento especificado por sua chave. Se você quiser remover um par chave/valor, você precisa aplicar a função unset() na chave.

```php
$arr = array(5 => 1, 12 => 2);

$arr[] = 56;    // Isto é o mesmo que $arr[13] = 56;
                // nesse ponto do script

$arr["x"] = 42; // Isto acrescenta um novo elemento
                // para o array com a chave "x"

unset($arr[5]); // Isto remove um elemento do array

unset($arr);    // E isto apaga todo o array
```

> Nota: Como mencionado acima, se nenhuma chave for especificada, o maior índice int é obtido, e a nova chave será esse o máximo + 1. Se nenhum índice int existir ainda, a chave será 0 (zero).
>
> Note que a chave inteira de maior valor utilizada não precisa necessariamente existir no array. Ele precisa ter existido no array em algum momento desde sua última reindexação do array. Veja o seguinte exemplo:
>
> ```php
> // Criando um array normal
> $array = array(1, 2, 3, 4, 5);
> print_r($array);
> 
> // Agora apagando todos os itens, mas deixando o array intacto:
> foreach ($array as $i => $value) {
>     unset($array[$i]);
> }
> print_r($array);
> 
> // Acrescentando um item (note que a chave é 5, em vez de zero).
> $array[] = 6;
> print_r($array);
> 
> // Reindexando:
> $array = array_values($array);
> $array[] = 7;
> print_r($array);
> ```
> 
> O exemplo acima produzirá:
> 
> ```bash
> Array
> (
>     [0] => 1
>     [1] => 2
>     [2] => 3
>     [3] => 4
>     [4] => 5
> )
> Array
> (
> )
> Array
> (
>     [5] => 6
> )
> Array
> (
>     [0] => 6
>     [1] => 7
> )
> ```

## Desconstruindo arrays

